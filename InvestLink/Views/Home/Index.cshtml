@{
    ViewData["Title"] = "Home Page";
}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Form for Approval on Establishing an Investment Project</title>
    <style>
        :root {
            --primary-color: #003366; /* أزرق داكن رسمي - Dark Navy Blue */
            --accent-color: #003366; /* تم تغيير الذهبي إلى نفس الأزرق الداكن لإزالة الخطوط الصفراء */
            --border-color: #ccc;
            --bg-color: #f4f6f8;
            --btn-add: #28a745;
            --btn-delete: #dc3545;
            --section-bg: #fff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            direction: rtl; /* Arabic Layout */
        }

        .container {
            width: 100%; /* جعل العرض مرن */
            max-width: 900px;
            background: white;
            padding: 40px;
            margin: 0 auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border-radius: 8px;
            border-top: 5px solid var(--primary-color);
            box-sizing: border-box; /* لضمان حساب الحواف داخل العرض */
        }

        /* Header Section */
        header {
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

            header h1 {
                color: var(--primary-color);
                margin: 10px 0;
                font-size: 1.8em;
                line-height: 1.3;
            }

            header h3, header h5 {
                margin: 5px 0;
                color: #444;
                font-weight: normal;
            }

            header h3, header h5 {
                /* color: black; */
            }

                header h3 {
                color: var(--primary-color);
                font-weight: bold;
                /* font-size: 1.2em; */
            }

            header .logo-placeholder {
                width: 100px;
                height: 100px;
                background-color: #f0f0f0;
                color: var(--primary-color);
                border: 2px solid var(--primary-color);
                margin: 0 auto 15px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                font-weight: bold;
                font-size: 1.2em;
            }

        hr {
            border: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, var(--primary-color), transparent);
            margin: 20px 0;
        }

        /* Form Sections */
        section {
            margin-bottom: 30px;
            padding: 25px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background-color: var(--section-bg);
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }

        h5.section-title {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 20px;
            margin: -25px -25px 25px -25px;
            border-radius: 5px 5px 0 0;
            font-size: 1.15em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* للسماح بلف النص في العناوين الطويلة */
            border-bottom: none;
            line-height: 1.4;
        }

            h5.section-title span {
                margin: 2px 0;
            }

        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 15px;
        }

            .form-group label {
                font-weight: bold;
                width: 35%;
                color: var(--primary-color);
                /* color: #333; */
                flex-shrink: 0;
            }

            .form-group input, .form-group select, .form-group textarea {
                flex-grow: 1;
                padding: 10px;
                border: 1px solid #ccc;
                border-radius: 4px;
                width: auto;
                transition: border-color 0.3s;
                box-sizing: border-box; /* مهم للتجاوب */
            }

        /* إخفاء الأسهم لحقول الأرقام */
        input[type=number]::-webkit-outer-spin-button,
        input[type=number]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type=number] {
            -moz-appearance: textfield;
        }

        .form-group input:focus, .form-group textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 51, 102, 0.1);
        }

        .form-group.block-style {
            display: block;
        }

            .form-group.block-style label {
                width: 100%;
                display: block;
                margin-bottom: 8px;
            }

            .form-group.block-style textarea, .form-group.block-style input {
                width: 100%;
                box-sizing: border-box;
            }

        /* Financial Items */
        .financial-item {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-right: 3px solid var(--primary-color);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }

            .financial-item h4 {
                margin-top: 0;
                color: var(--primary-color);
                border-bottom: 1px solid #e0e0e0;
                padding-bottom: 8px;
                margin-bottom: 15px;
                font-size: 1.05em;
            }

        .sub-fields-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* تحسين: جعل الحد الأدنى أصغر */
            gap: 10px;
        }

        .sub-field label {
            display: block;
            font-size: 0.85em;
            color: #666;
            margin-bottom: 5px;
        }

        .sub-field input {
            width: 100%;
            box-sizing: border-box;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        input.calc-total {
            background-color: #fff;
        }

        /* Dynamic Buttons */
        .btn-add-row {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

            .btn-add-row:hover {
                background-color: #002244;
            }

        .btn-delete-card {
            background-color: transparent;
            color: var(--btn-delete);
            border: 1px solid var(--btn-delete);
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-right: auto;
            transition: all 0.2s;
        }

            .btn-delete-card:hover {
                background-color: var(--btn-delete);
                color: white;
            }

        .investor-card {
            border: 1px solid #e0e0e0;
            background-color: #fff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 6px;
            position: relative;
            border-top: 3px solid var(--primary-color);
        }

        .investor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 10px;
        }

            .investor-header h5 {
                margin: 0;
                /* color: var(--primary-color); */
                font-size: 1.1em;
            }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

            .grid-2 .form-group, .grid-3 .form-group {
                display: block;
                margin-bottom: 0;
            }

                .grid-2 .form-group label, .grid-3 .form-group label {
                    width: 100%;
                    margin-bottom: 5px;
                }

                .grid-2 .form-group input, .grid-3 .form-group input {
                    width: 100%;
                    box-sizing: border-box;
                }

        .btn-submit {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 30px;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            border-radius: 5px;
            display: block;
            width: 100%;
            margin-top: 20px;
            font-weight: bold;
            border-bottom: 4px solid #002244;
        }

            .btn-submit:active {
                transform: translateY(2px);
                border-bottom: 2px solid #002244;
            }

        .en-label {
            display: block;
            font-size: 0.85em;
            color: #777;
            font-weight: normal;
            margin-top: 2px;
        }

        /* Responsive Design Rules */
        media (max-width: 768px) {
            body

        {
            padding: 10px;
        }

        .container {
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* Typography Scale */
        header h1 {
            font-size: 1.4em;
        }

        /* header h2 {
            font-size: 1.1em;
        } */

        /* header h3 {
            font-size: 0.9em;
        } */


        h5.section-title {
            /* font-size: 1em; */
            padding: 10px 15px;
        }

        /* Stack Form Groups */
        .form-group {
            flex-direction: column;
            align-items: stretch;
            gap: 5px;
        }

            .form-group label {
                width: 100%;
                margin-bottom: 5px;
            }

        /* Stack Grids */
        .grid-2, .grid-3 {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        /* Adjust Financial Grids */
        .sub-fields-grid {
            grid-template-columns: 1fr; /* صف واحد في الموبايل */
        }

        .investor-card, section {
            padding: 15px;
        }

        }

        media (max-width: 480px) {
            .container

        {
            padding: 15px;
        }

        .logo-placeholder {
            width: 80px;
            height: 80px;
            font-size: 1em;
        }

        h5.section-title {
            flex-direction: column;
            align-items: flex-start;
        }

        .btn-submit {
            font-size: 1em;
            padding: 12px;
        }

        }

        /* Print Design Rules */
        media print {
            body

        {
            background-color: white;
            padding: 0;
            font-size: 12px;
        }

        .container {
            box-shadow: none;
            border: none;
            width: 100%;
            margin: 0;
            padding: 0;
            max-width: 100%;
        }

        .btn-submit, .btn-add-row, .btn-delete-card {
            display: none !important;
        }

        .investor-card, .financial-item {
            border: 1px solid #999;
            break-inside: avoid;
            page-break-inside: avoid;
        }

        section {
            page-break-inside: avoid;
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 15px;
        }

        h5.section-title {
            background-color: #eee !important;
            /* color: black !important; */
            border-bottom: 1px solid #999;
            -webkit-print-color-adjust: exact;
        }

        input, textarea {
            border: 1px solid #ddd;
        }
        /* Ensure layout remains somewhat normal in print but fitting A4 */
        .form-group {
            display: flex;
            flex-direction: row;
        }

            .form-group label {
                width: 30%;
            }

        .sub-fields-grid {
            grid-template-columns: repeat(5, 1fr) !important;
        }
        /* Force grid in print */
        }

        header h5, h3 {
            color: var(--primary-color);
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- Header -->
        <header>
            @* <div class="logo-placeholder">P.I.B LOGO</div> *@
            <h3>  الهيئة العامة لتشجيع الاستثمار وشؤون الخصخصة</h3>
            <br />
            <h5>طلب موافقة على إقامة مشروع استثماري</h5>
          
            <hr>
        </header>

        <form>
            <!-- Section 1: Applicant Data -->
            <section>
                <h3 class="section-title">
                    <span>أولاً: بيانات عن مقدم الطلب</span>
                    <span>First: Applicant's Personal Data</span>
                </h3>

                <div class="form-group">
                    <label>أسم مقدم الطلب <span class="en-label">Name of applicant</span></label>
                    <input type="text" name="applicant_name">
                </div>
                <div class="form-group">
                    <label>الصفة <span class="en-label">Position</span></label>
                    <input type="text" name="position">
                </div>
                <div class="form-group">
                    <label>الجنسية <span class="en-label">Nationality</span></label>
                    <input type="text" name="nationality">
                </div>
                <div class="form-group">
                    <label>البطاقة أو جواز السفر (مرفق صورة) <span class="en-label">I.D Card or Passport no (copy attached)</span></label>
                    <input type="text" name="passport_id">
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>الهاتف / النقال <span class="en-label">Tel / Mobile</span></label>
                        <input type="text" name="phone">
                    </div>
                    <div class="form-group">
                        <label>الفاكس / البريد الإلكتروني <span class="en-label">Fax / E-mail</span></label>
                        <input type="text" name="email_fax">
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>التاريخ <span class="en-label">Date</span></label>
                        <input type="date" name="date">
                    </div>
                    <div class="form-group">
                        <label>التوقيع <span class="en-label">Signature</span></label>
                        <input type="text" placeholder="Digital Signature or Print">
                    </div>
                </div>
            </section>


       
            <!-- Section 2: Investor Data -->
            <section>
                <h3 class="section-title">
                    <span>ثانياً: بيانات عن المستثمر</span>
                    <span>Second: Investor's Data</span>
                </h3>

                <div id="investors-container">
                    <!-- Investor cards will be inserted here -->
                </div>

                <button type="button" class="btn-add-row" onclick="addInvestorCard()">
                    <span>+</span> إضافة مستثمر جديد / Add Investor
                </button>
            </section>

            <!-- Section 3: Project Detail -->
            <section>
                <h3 class="section-title">
                    <span>ثالثاً: معلومات أولية عن المشروع</span>
                    <span>Third: Project's detail</span>
                </h3>
                <div class="form-group">
                    <label>1. أسم المشروع <span class="en-label">Project's name</span></label>
                    <input type="text" name="project_name">
                </div>
                <div class="form-group">
                    <label>2. الشكل القانوني للمشروع <span class="en-label">Legal body of the project</span></label>
                    <input type="text" name="legal_body">
                </div>
                <div class="form-group">
                    <label>3. مجال الاستثمار <span class="en-label">Area of investment</span></label>
                    <input type="text" name="investment_area">
                </div>
                <div class="form-group">
                    <label>4. نوع النشاط <span class="en-label">Type of activity</span></label>
                    <input type="text" name="activity_type">
                </div>
                <div class="form-group">
                    <label>5. الموقع المقترح <span class="en-label">Proposed Site</span></label>
                    <input type="text" name="site">
                </div>
                <div class="form-group">
                    <label>6. المساحة المطلوبة <span class="en-label">Area Wanted</span></label>
                    <input type="text" name="area_wanted">
                </div>
                <div class="form-group">
                    <label>7. نوع الانتفاع بالموقع <span class="en-label">Type of benefit from site</span></label>
                    <input type="text" name="benefit_type">
                </div>
                <div class="form-group">
                    <label>8. مدة تنفيذ المشروع <span class="en-label">Project time line</span></label>
                    <input type="text" name="timeline">
                </div>
                <div class="form-group">
                    <label>9. العمر الافتراضي للمشروع <span class="en-label">Construction period</span></label>
                    <input type="text" name="lifespan">
                </div>
            </section>

            <!-- Section 4: Sources of funding -->
            <section id="funding-section">
                <h3 class="section-title">
                    <span>10. مصادر تمويل التكاليف الاستثمارية</span>
                    <span>Sources of funding</span>
                </h3>

                <!-- Items - Converted input type="number" to type="text" to allow free typing -->

                <div class="financial-item sec10-item">
                    <h4>رأس المال / Capital</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field">
                            <label>عملة أجنبية / Foreign Currency</label>
                            <input type="text" class="inp-foreign" oninput="updateRow(this, 'funding')">
                        </div>
                        <div class="sub-field">
                            <label>ما يعادله بالعملة الوطنية / Eq. Local Currency</label>
                            <input type="text" class="inp-eq" oninput="updateRow(this, 'funding')">
                        </div>
                        <div class="sub-field">
                            <label>وطني / Local</label>
                            <input type="text" class="inp-local" oninput="updateRow(this, 'funding')">
                        </div>
                        <div class="sub-field">
                            @* <label>الإجمالي / Total</label> *@
                            <input type="text" class="inp-total calc-total" oninput="updateTotals('funding')">
                        </div>
                        <div class="sub-field">
                            <label>ملاحظات / Notes</label>
                            <input type="text">
                        </div>
                    </div>
                </div>

                <div class="financial-item sec10-item">
                    <h4>تمويل شركاء / Partner funding</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>عملة أجنبية</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'funding')"></div>
                        @* <div class="sub-field"><label>ما يعادله وطني</label><input type="text" class="inp-eq" oninput="updateRow(this, 'funding')"></div> *@
                        @* <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'funding')"></div> *@
                        @* <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('funding')"></div> *@
                        <div class="sub-field"><label>ملاحظات</label><input type="text"></div>
                    </div>
                </div>

                <div class="financial-item sec10-item">
                    <h4>قروض أجنبية / Foreign Loans</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>عملة أجنبية</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'funding')"></div>
                        @* <div class="sub-field"><label>ما يعادله وطني</label><input type="text" class="inp-eq" oninput="updateRow(this, 'funding')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'funding')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('funding')"></div> *@
                        <div class="sub-field"><label>ملاحظات</label><input type="text"></div>
                    </div>
                </div>

                <div class="financial-item sec10-item">
                    <h4>قروض محلية / Local loans</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>عملة أجنبية</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'funding')"></div>
                        @* <div class="sub-field"><label>ما يعادله وطني</label><input type="text" class="inp-eq" oninput="updateRow(this, 'funding')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'funding')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('funding')"></div> *@
                        <div class="sub-field"><label>ملاحظات</label><input type="text"></div>
                    </div>
                </div>

                <div class="financial-item sec10-item">
                    <h4>مصادر أخرى / Other sources</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>عملة أجنبية</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'funding')"></div>
                        @* <div class="sub-field"><label>ما يعادله وطني</label><input type="text" class="inp-eq" oninput="updateRow(this, 'funding')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'funding')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('funding')"></div> *@
                        <div class="sub-field"><label>ملاحظات</label><input type="text"></div>
                    </div>
                </div>

                <!-- Total -->
                <div class="financial-item" style="border: 2px solid var(--primary-color);">
                    <h4>الإجمالي العام / Grand Total</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field">
                            <label>إجمالي عملة أجنبية</label>
                            <input type="text" id="total-funding-foreign" class="calc-total">
                        </div>
                        <div class="sub-field">
                            <label>إجمالي معادل وطني</label>
                            <input type="text" id="total-funding-eq" class="calc-total">
                        </div>
                        <div class="sub-field">
                            <label>إجمالي وطني</label>
                            <input type="text" id="total-funding-local" class="calc-total">
                        </div>
                        <div class="sub-field">
                            <label>الإجمالي الكلي بالدينار</label>
                            <input type="text" id="total-funding-grand" class="calc-total">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Capital Costs -->
            <section id="costs-section">
                <h3 class="section-title">
                    <span>11. التكاليف الاستثمارية للمشروع</span>
                    <span>Project's capital costs</span>
                </h3>

                <div class="financial-item sec11-item">
                    <h4>أرض / Land</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني / Local</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>أجنبي / Foreign</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي / Total</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>مباني و إنشاءات / Buildings and structures</h4>
                    <div class="sub-fields-grid">
                        @* <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div> *@
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>آلات ومعدات / Machinery and equipment</h4>
                    <div class="sub-fields-grid">
                        @* <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div> *@
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>وسائل نقل مختلفة / Various means of transportation</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>أثاث وتجهيزات / Furniture and appliances</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>حق المعرفة (إن وجدت) / Knowhow</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>مصروفات تأسيس / Establishment expenses</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item sec11-item">
                    <h4>رأس المال العامل / Working capital</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>معادل بالعملة الوطنية</label><input type="text" class="inp-eq" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>وطني</label><input type="text" class="inp-local" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>أجنبي</label><input type="text" class="inp-foreign" oninput="updateRow(this, 'costs')"></div>
                        <div class="sub-field"><label>الإجمالي</label><input type="text" class="inp-total calc-total" oninput="updateTotals('costs')"></div>
                    </div>
                </div>

                <div class="financial-item" style="border: 2px solid var(--primary-color);">
                    <h4>إجمالي قيمة التكاليف الاستثمارية / Total investment costs</h4>
                    <div class="sub-fields-grid">
                        <div class="sub-field"><label>إجمالي معادل وطني</label><input type="text" id="total-cost-eq" class="calc-total"></div>
                        <div class="sub-field"><label>إجمالي وطني</label><input type="text" id="total-cost-local" class="calc-total"></div>
                        <div class="sub-field"><label>إجمالي أجنبي</label><input type="text" id="total-cost-foreign" class="calc-total"></div>
                        <div class="sub-field"><label>الإجمالي الكلي</label><input type="text" id="total-cost-grand" class="calc-total"></div>
                    </div>
                </div>
            </section>

            <!-- Section 6: Details -->
            <section>
                <h3 class="section-title"><span>تفاصيل المشروع الإضافية</span><span>Additional Project Details</span></h3>

                <div class="form-group block-style">
                    <label>12. نبذة عن المشروع <span class="en-label">About the project</span></label>
                    <textarea rows="4"></textarea>
                </div>

                <div class="form-group block-style">
                    <label>13. التقنية المستخدمة <span class="en-label">Applied technology</span></label>
                    <input type="text">
                </div>

                <div class="form-group block-style">
                    <label>نوع الآلات والمعدات (إن وجدت، يرفق بيان تفصيلي) <span class="en-label">Type of machinery and equipment</span></label>
                    <textarea rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label>14. مصادر المواد الخام المستخدمة <span class="en-label">Sources of raw material</span></label>
                    <div style="display: flex; gap: 10px; flex-grow: 1;">
                        <input type="text" placeholder="محلية Local %">
                        <input type="text" placeholder="أجنبية Foreign %">
                    </div>
                </div>

                <div class="form-group block-style">
                    <label>15. الأثر البيئي للمشروع وطرق معالجته (إن وجدت) <span class="en-label">Environmental impact</span></label>
                    <textarea rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label>16. نوع السلعة المنتجة أو الخدمة المقدمة <span class="en-label">Type of produced goods/services</span></label>
                    <input type="text">
                </div>

                <div class="form-group">
                    <label>17. الطاقة الإنتاجية أو الاستيعابية <span class="en-label">Energy production (Capacity)</span></label>
                    <input type="text">
                </div>

                <div class="form-group">
                    <label>18. العمالة المستخدمة <span class="en-label">Employment of Manpower</span></label>
                    <div style="display: flex; gap: 10px; flex-grow: 1;">
                        <input type="text" placeholder="وطنية Local">
                        <input type="text" placeholder="أجنبية Foreign">
                    </div>
                </div>

                <div class="form-group block-style">
                    <label>19. البرامج التدريبية للعمالة الوطنية بالمشروع <span class="en-label">Training Programs to local manpower</span></label>
                    <textarea rows="2"></textarea>
                </div>

                <div class="form-group block-style">
                    <label>20. خبرة المستثمر في هذا النشاط أو أي نشاط آخر <span class="en-label">Investor Experience</span></label>
                    <textarea rows="2"></textarea>
                </div>

                <div class="form-group block-style">
                    <label>21. أي بيانات إضافية <span class="en-label">Any additional information</span></label>
                    <textarea rows="2"></textarea>
                </div>
            </section>

            <!-- Authority Notes -->
            @* <section style="background-color: #f0f0f0;">
                <h3 class="section-title" style="background-color: #555;">
                    <span>22. ملاحظات الهيئة (تعبأ من قبل إدارة الهيئة)</span>
                    <span>Authority Notes (For official use only)</span>
                </h3>
                <textarea rows="5" disabled style="background-color: #e0e0e0; width: 100%; box-sizing: border-box;"></textarea>
            </section> *@

            <button type="button" class="btn-submit" onclick="window.print()">طباعة النموذج / Print Form</button>
        </form>
    </div>

    <script>
        window.onload = function() {
            addInvestorCard();
        };

        function addInvestorCard() {
            const container = document.getElementById('investors-container');
            const count = container.children.length + 1;

            const cardHTML = `
                <div class="investor-card" id="investor-${count}">
                    <div class="investor-header">
                        <h4>المستثمر ${count}</h4>
                        <button type="button" class="btn-delete-card" onclick="removeInvestorCard(this)">حذف / Remove</button>
                    </div>

                    <div class="form-group">
                        <label>أسم المستثمر <span class="en-label">Investor's Name</span></label>
                        <input type="text">
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>الجنسية <span class="en-label">Nationality</span></label>
                            <input type="text">
                        </div>
                        <div class="form-group">
                            <label>الهاتف <span class="en-label">Tel</span></label>
                            <input type="text">
                        </div>
                    </div>

                    <div class="grid-3">
                        <div class="form-group">
                            <label>قيمة المساهمة <span class="en-label">Valuable contribution</span></label>
                            <input type="text">
                        </div>
                        <div class="form-group">
                            <label>نوع العملة <span class="en-label">Type of Currency</span></label>
                            <input type="text">
                        </div>
                        <div class="form-group">
                            <label>نسبة المساهمة <span class="en-label">% of contribution</span></label>
                            <input type="text">
                        </div>
                    </div>
                </div>
            `;

            container.insertAdjacentHTML('beforeend', cardHTML);
            updateInvestorTitles();
        }

        function removeInvestorCard(btn) {
            const container = document.getElementById('investors-container');
            if (container.children.length > 1) {
                btn.closest('.investor-card').remove();
                updateInvestorTitles();
            } else {
                const inputs = btn.closest('.investor-card').querySelectorAll('input');
                inputs.forEach(input => input.value = '');
            }
        }

        function updateInvestorTitles() {
            const cards = document.querySelectorAll('.investor-card');
            cards.forEach((card, index) => {
                card.querySelector('h4').textContent = `المستثمر ${index + 1}`;
            });
        }

        // Helper to safely parse numbers from text (handles "1,000", "500 LYD", etc.)
        function getVal(el) {
            if (!el || !el.value) return 0;
            // Remove commas and non-numeric chars (except dot)
            // Keep it simple: treat it as float if possible
            const cleaned = el.value.replace(/[^0-9.]/g, '');
            return parseFloat(cleaned) || 0;
        }

        function updateRow(element, sectionType) {
            // Find the parent item
            const row = element.closest('.financial-item');

            const eq = getVal(row.querySelector('.inp-eq'));
            const local = getVal(row.querySelector('.inp-local'));

            // Auto-calculate Row Total = Eq + Local
            // Only update if we have meaningful numbers to sum
            const rowTotal = eq + local;

            const totalInput = row.querySelector('.inp-total');
            if(totalInput) {
                // Only update if the calculated total is greater than 0,
                // OR if the user cleared inputs (rowTotal is 0)
                // This prevents overwriting manual text if inputs are 0
                if (rowTotal > 0 || (eq === 0 && local === 0)) {
                    totalInput.value = rowTotal || '';
                }
            }

            updateTotals(sectionType);
        }

        function updateTotals(sectionType) {
            let itemsClass = sectionType === 'funding' ? '.sec10-item' : '.sec11-item';
            let prefix = sectionType === 'funding' ? 'total-funding' : 'total-cost';

            const items = document.querySelectorAll(itemsClass);
            let totalForeign = 0;
            let totalEq = 0;
            let totalLocal = 0;
            let grandTotal = 0;

            items.forEach(item => {
                totalForeign += getVal(item.querySelector('.inp-foreign'));
                totalEq += getVal(item.querySelector('.inp-eq'));
                totalLocal += getVal(item.querySelector('.inp-local'));
                grandTotal += getVal(item.querySelector('.inp-total'));
            });

            document.getElementById(prefix + '-foreign').value = totalForeign || '';
            document.getElementById(prefix + '-eq').value = totalEq || '';
            document.getElementById(prefix + '-local').value = totalLocal || '';
            document.getElementById(prefix + '-grand').value = grandTotal || '';
        }
    </script>

</body>
</html>